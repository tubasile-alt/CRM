<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Prescricao Medica</title>

    <style>
        @page {
            size: A4;
            margin: 2.5cm;
        }

        body {
            font-family: "Times New Roman", serif;
            color: #000;
        }

        h1 {
            text-align: center;
            font-size: 18px;
            margin-bottom: 5px;
        }

        .patient {
            text-align: center;
            font-size: 14px;
            margin-bottom: 10px;
        }

        hr {
            border: none;
            border-top: 1px solid #000;
            margin: 15px 0;
        }

        .section-title {
            font-weight: bold;
            margin-top: 20px;
            margin-bottom: 5px;
            font-size: 14px;
        }

        .medication {
            margin-left: 15px;
            margin-bottom: 8px;
            font-size: 13px;
        }

        .footer {
            margin-top: 60px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .stamp {
            width: 260px;
        }

        .stamp img {
            width: 100%;
        }

        .date {
            font-size: 13px;
        }

        /* ISSO GARANTE QUE O CHROME IMPRIMA A IMAGEM */
        @media print {
            body {
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
        }
    </style>
</head>
<body>

    <h1>PRESCRICAO MEDICA</h1>

    <div class="patient">
        <strong>Paciente:</strong> {{ patient.name }}
    </div>

    <hr>

    {% if prescription.medications_topical %}
        <div class="section-title">Uso Topico</div>
        {% for med in prescription.medications_topical %}
            <div class="medication">
                <strong>{{ med.medication if med is mapping else med }}</strong><br>
                {{ med.instructions if med is mapping else '' }}
            </div>
        {% endfor %}
    {% endif %}

    {% if prescription.medications_oral %}
        <div class="section-title">Uso Oral</div>
        {% for med in prescription.medications_oral %}
            <div class="medication">
                <strong>{{ med.medication if med is mapping else med }}</strong><br>
                {{ med.instructions if med is mapping else '' }}
            </div>
        {% endfor %}
    {% endif %}

    <div class="footer">
        <div class="stamp">
            <img src="{{ url_for('static', filename='img/carimbo.png') }}">
        </div>

        <div class="date">
            Data: {{ prescription.created_at.strftime('%d/%m/%Y') if prescription.created_at else '' }}
        </div>
    </div>

    <script>
        window.onload = function() {
            setTimeout(function() {
                window.print();
            }, 500);
        };
    </script>

</body>
</html>
